{"version":3,"file":"sidemenu.min.js","sources":["../../src/js/sidemenu.js","../../src/js/utils.js"],"sourcesContent":["// @ts-check\n\nimport {\n\tclosest,\n\tensureElementHasId,\n\tonDomReady,\n\tprependNode,\n} from \"./utils.js\";\n\nonDomReady(initSidemenus);\n\n/**\n * Add a close/open toggle behaviour to the sidemenus. Safe to call again to\n * apply to newly added sidemenus.\n */\nexport function initSidemenus() {\n\tvar sidemenus = document.querySelectorAll(\".sidemenu > nav\");\n\tfor (var i = 0; i < sidemenus.length; i++) {\n\t\tvar sidemenu = sidemenus[i];\n\t\tif (!(sidemenu instanceof HTMLElement)) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (!sidemenu.querySelector(\"button.sidemenu-toggle\")) {\n\t\t\taddToggleButton(sidemenu);\n\t\t}\n\t}\n}\n\n/**\n * @param {HTMLElement} sidemenu\n */\nfunction addToggleButton(sidemenu) {\n\tvar main = closest(sidemenu, \".sidemenu\");\n\tvar ul = sidemenu.querySelector(\"ul\");\n\n\tif (!main || !ul) {\n\t\treturn;\n\t}\n\n\tensureElementHasId(ul);\n\n\tvar openLabel = sidemenu.dataset.openLabel || \"Zijbalknavigatie\";\n\tvar closeLabel = sidemenu.dataset.closeLabel || \"Sluit zijbalknavigatie\";\n\tvar openIcon = \"ro-icon-hamburger\";\n\tvar closeIcon = \"ro-icon-close\";\n\n\tvar button = document.createElement(\"button\");\n\tbutton.className = \"ro-icon secondary sidemenu-toggle\";\n\tbutton.setAttribute(\"aria-controls\", ul.id);\n\n\tfunction isClosed() {\n\t\treturn main.classList.contains(\"sidemenu-closed\");\n\t}\n\n\tfunction setClosed(closed) {\n\t\tbutton.innerText = closed ? closeLabel : openLabel;\n\t\tbutton.classList.add(closed ? openIcon : closeIcon);\n\t\tbutton.classList.remove(closed ? closeIcon : openIcon);\n\t\tbutton.setAttribute(\"aria-expanded\", String(!closed));\n\t\tif (closed) {\n\t\t\tmain.classList.add(\"sidemenu-closed\");\n\t\t} else {\n\t\t\tmain.classList.remove(\"sidemenu-closed\");\n\t\t}\n\t}\n\n\tsetClosed(isClosed());\n\n\tbutton.addEventListener(\"click\", function () {\n\t\tsetClosed(!isClosed());\n\t});\n\n\tprependNode(sidemenu, button);\n}\n","/**\n * Run the given callback function once after the DOM is ready.\n *\n * @param {() => void} fn\n */\nexport function onDomReady(fn) {\n\tif (document.readyState !== \"loading\") return fn();\n\tdocument.addEventListener(\"DOMContentLoaded\", fn);\n}\n\n/**\n * Provide the given element with a unique generated `id`, if it does not have one already.\n *\n * @param {HTMLElement} element\n */\nexport function ensureElementHasId(element) {\n\tif (!element.id) {\n\t\telement.id =\n\t\t\telement.tagName + \"-\" + (~~(Math.random() * 1e9) + 1e9).toString(16);\n\t}\n}\n\n/**\n * Set up a matchMedia change event listener. Returns a function that, when\n * called, will remove the event listener again.\n *\n * @param {string} media\n * @param {(event: { matches: boolean }) => void} handler\n * @return {() => void}\n */\nexport function onMediaQueryMatch(media, handler) {\n\tvar mql = window.matchMedia(media);\n\n\tif (mql.addEventListener) {\n\t\tmql.addEventListener(\"change\", handler);\n\t} else {\n\t\tmql.addListener(handler);\n\t}\n\n\thandler(mql);\n\n\treturn function remove() {\n\t\tif (mql.addEventListener) {\n\t\t\tmql.removeEventListener(\"change\", handler);\n\t\t} else {\n\t\t\tmql.removeListener(handler);\n\t\t}\n\t};\n}\n\n/**\n * @param {HTMLElement} parent\n * @param {HTMLElement} child\n */\nexport function prependNode(parent, child) {\n\tvar children = parent.childNodes;\n\tif (children.length) parent.insertBefore(child, children[0]);\n\telse parent.appendChild(child);\n}\n\n/**\n * Set up a MutationObserver. Returns a disconnect function.\n * @param {() => void} handler\n * @param {HTMLElement | undefined} [root]\n * @return {undefined|() => void}\n */\nexport function onDomUpdate(handler, root) {\n\tif (\"MutationObserver\" in window) {\n\t\tvar observer = new MutationObserver(handler);\n\t\tobserver.observe(root || document, { childList: true, subtree: true });\n\t\treturn observer.disconnect.bind(observer);\n\t}\n}\n\n/**\n * Ponyfill for Element.prototype.closest.\n * @param {Element} element\n * @param {DOMString} selectors\n * @return {Element | null}\n */\nexport function closest(element, selectors) {\n\tif (Element.prototype.closest) {\n\t\treturn element.closest(selectors);\n\t}\n\tvar matches =\n\t\tElement.prototype.matches ||\n\t\tElement.prototype.msMatchesSelector ||\n\t\tElement.prototype.webkitMatchesSelector;\n\n\tdo {\n\t\tif (matches.call(element, selectors)) {\n\t\t\treturn element;\n\t\t}\n\t\telement = element.parentElement || element.parentNode;\n\t} while (element !== null && element.nodeType === 1);\n\n\treturn null;\n}\n"],"names":["initSidemenus","sidemenus","document","querySelectorAll","i","length","sidemenu","HTMLElement","querySelector","addToggleButton","main","element","selectors","Element","prototype","closest","matches","msMatchesSelector","webkitMatchesSelector","call","parentElement","parentNode","nodeType","ul","id","tagName","Math","random","toString","parent","child","children","openLabel","dataset","closeLabel","button","createElement","className","setAttribute","setClosed","isClosed","addEventListener","childNodes","insertBefore","appendChild","classList","contains","closed","innerText","add","remove","String","fn","readyState","onDomReady"],"mappings":"gCAeO,SAASA,gBAEf,IADA,IAAIC,UAAYC,SAASC,iBAAiB,mBACjCC,EAAI,EAAGA,EAAIH,UAAUI,OAAQD,IAAK,CAC1C,IAAIE,SAAWL,UAAUG,GACnBE,oBAAoBC,cAGrBD,SAASE,cAAc,2BAC3BC,gBAAgBH,YAQnB,SAASG,gBAAgBH,UACxB,IAAII,KCgDE,SAAiBC,QAASC,WAChC,GAAIC,QAAQC,UAAUC,QACrB,OAAOJ,QAAQI,QAAQH,WAExB,IAAII,QACHH,QAAQC,UAAUE,SAClBH,QAAQC,UAAUG,mBAClBJ,QAAQC,UAAUI,sBAEnB,EAAG,CACF,GAAIF,QAAQG,KAAKR,QAASC,WACzB,OAAOD,QAERA,QAAUA,QAAQS,eAAiBT,QAAQU,iBACvB,OAAZV,SAAyC,IAArBA,QAAQW,UAErC,OAAO,KDhEIP,CAAQT,SAAU,aACzBiB,GAAKjB,SAASE,cAAc,MAEhC,GAAKE,MAASa,GAAd,CCpBM,IAA4BZ,SAAAA,QDwBfY,ICvBNC,KACZb,QAAQa,GACPb,QAAQc,QAAU,KAAiC,OAAP,IAAhBC,KAAKC,WAAuBC,SAAS,KDuBnE,ICa2BC,OAAQC,MAC/BC,SDdAC,UAAY1B,SAAS2B,QAAQD,WAAa,mBAC1CE,WAAa5B,SAAS2B,QAAQC,YAAc,yBAI5CC,OAASjC,SAASkC,cAAc,UACpCD,OAAOE,UAAY,oCACnBF,OAAOG,aAAa,gBAAiBf,GAAGC,IAkBxCe,UAAUC,YAEVL,OAAOM,iBAAiB,SAAS,WAChCF,WAAWC,eCfuBV,MDkBbK,QCjBlBJ,UADuBF,ODkBfvB,UCjBUoC,YACTrC,OAAQwB,OAAOc,aAAab,MAAOC,SAAS,IACpDF,OAAOe,YAAYd,ODPxB,SAASU,WACR,OAAO9B,KAAKmC,UAAUC,SAAS,mBAGhC,SAASP,UAAUQ,QAClBZ,OAAOa,UAAYD,OAASb,WAAaF,UACzCG,OAAOU,UAAUI,IAAIF,OAbP,oBACC,iBAafZ,OAAOU,UAAUK,OAAOH,OAbT,gBADD,qBAedZ,OAAOG,aAAa,gBAAiBa,QAAQJ,SACzCA,OACHrC,KAAKmC,UAAUI,IAAI,mBAEnBvC,KAAKmC,UAAUK,OAAO,qBCzDlB,SAAoBE,IAC1B,GAA4B,YAAxBlD,SAASmD,WAA0B,OAAOD,KAC9ClD,SAASuC,iBAAiB,mBAAoBW,KDE/CE,CAAWtD"}