{"version":3,"file":"navigation.min.js","sources":["../../src/js/utils.js","../../src/js/navigation.js"],"sourcesContent":["/**\n * Run the given callback function once after the DOM is ready.\n *\n * @param {() => void} fn\n */\nexport function onDomReady(fn) {\n\tif (document.readyState !== \"loading\") return fn();\n\tdocument.addEventListener(\"DOMContentLoaded\", fn);\n}\n\n/**\n * Provide the given element with a unique generated `id`, if it does not have one already.\n *\n * @param {HTMLElement} element\n */\nexport function ensureElementHasId(element) {\n\tif (!element.id) {\n\t\telement.id =\n\t\t\telement.tagName + \"-\" + (~~(Math.random() * 1e9) + 1e9).toString(16);\n\t}\n}\n\n/**\n * Set up a matchMedia change event listener. Returns a function that, when\n * called, will remove the event listener again.\n *\n * @param {string} media\n * @param {(event: { matches: boolean }) => void} handler\n * @return {() => void}\n */\nexport function onMediaQueryMatch(media, handler) {\n\tvar mql = window.matchMedia(media);\n\n\tif (mql.addEventListener) {\n\t\tmql.addEventListener(\"change\", handler);\n\t} else {\n\t\tmql.addListener(handler);\n\t}\n\n\thandler(mql);\n\n\treturn function remove() {\n\t\tif (mql.addEventListener) {\n\t\t\tmql.removeEventListener(\"change\", handler);\n\t\t} else {\n\t\t\tmql.removeListener(handler);\n\t\t}\n\t};\n}\n\n/**\n * @param {HTMLElement} parent\n * @param {HTMLElement} child\n */\nexport function prependNode(parent, child) {\n\tvar children = parent.childNodes;\n\tif (children.length) parent.insertBefore(child, children[0]);\n\telse parent.appendChild(child);\n}\n\n/**\n * Set up a MutationObserver. Returns a disconnect function.\n * @param {() => void} handler\n * @param {HTMLElement | undefined} [root]\n * @return {undefined|() => void}\n */\nexport function onDomUpdate(handler, root) {\n\tif (\"MutationObserver\" in window) {\n\t\tvar observer = new MutationObserver(handler);\n\t\tobserver.observe(root || document, { childList: true, subtree: true });\n\t\treturn observer.disconnect.bind(observer);\n\t}\n}\n\n/**\n * Ponyfill for Element.prototype.closest.\n * @param {Element} element\n * @param {DOMString} selectors\n * @return {Element | null}\n */\nexport function closest(element, selectors) {\n\tif (Element.prototype.closest) {\n\t\treturn element.closest(selectors);\n\t}\n\tvar matches =\n\t\tElement.prototype.matches ||\n\t\tElement.prototype.msMatchesSelector ||\n\t\tElement.prototype.webkitMatchesSelector;\n\n\tdo {\n\t\tif (matches.call(element, selectors)) {\n\t\t\treturn element;\n\t\t}\n\t\telement = element.parentElement || element.parentNode;\n\t} while (element !== null && element.nodeType === 1);\n\n\treturn null;\n}\n","// @ts-check\n\nimport { ensureElementHasId, onMediaQueryMatch, onDomReady } from \"./utils.js\";\n\nonDomReady(initNaviation);\n\n/**\n * Add responsive behaviour to header navigation. Safe to call again to make a\n * newly added header navigation responsive.\n */\nexport function initNaviation() {\n\tvar headers = document.querySelectorAll(\"header:not(.breadcrumbs)\");\n\tfor (var i = 0; i < headers.length; i++) {\n\t\tvar nav = headers[i].querySelector(\"nav\");\n\t\tif (!(nav instanceof HTMLElement) || nav.querySelector(\".menu_toggle\")) {\n\t\t\tcontinue;\n\t\t}\n\t\tvar isCondensed = headers[i].className.indexOf(\"condensed\") !== -1;\n\t\tmakeResponsive(nav, isCondensed);\n\t}\n}\n\n/**\n * @param {HTMLElement} nav\n * @param {boolean} isCondensed\n */\nfunction makeResponsive(nav, isCondensed) {\n\tvar menu = nav.querySelector(\"ul, ol\");\n\tif (!(menu instanceof HTMLElement)) {\n\t\treturn;\n\t}\n\tensureElementHasId(menu);\n\n\tvar button = createMenuButton(\n\t\tmenu,\n\t\tnav.dataset.openLabel || \"Menu\",\n\t\tnav.dataset.closeLabel || \"Sluit menu\"\n\t);\n\n\tmenu.parentNode.insertBefore(button.element, menu);\n\n\tif (!isCondensed) {\n\t\tonMediaQueryMatch(\n\t\t\tnav.dataset.media || \"(min-width: 42rem)\",\n\t\t\tfunction (event) {\n\t\t\t\tbutton.setExpanded(false);\n\t\t\t\tif (event.matches) {\n\t\t\t\t\tnav.classList.remove(\"collapsible-menu\");\n\t\t\t\t} else {\n\t\t\t\t\tnav.classList.add(\"collapsible-menu\");\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n}\n\n/**\n * @param {HTMLElement} ul\n * @param {string} openLabel\n * @param {string} closeLabel\n * @return {{ element: HTMLButtonElement, setExpanded: (expanded: boolean) => void }}\n */\nfunction createMenuButton(ul, openLabel, closeLabel) {\n\tvar button = document.createElement(\"button\");\n\tbutton.className = \"menu_toggle\";\n\tbutton.setAttribute(\"hidden\", \"false\");\n\tbutton.setAttribute(\"aria-controls\", ul.id);\n\tbutton.setAttribute(\"aria-expanded\", \"false\");\n\n\tvar label = document.createElement(\"span\");\n\tlabel.innerText = openLabel;\n\tlabel.className = \"sr-only\";\n\tensureElementHasId(label);\n\n\tbutton.appendChild(label);\n\tbutton.setAttribute(\"aria-labelledby\", label.id);\n\n\tfunction setExpanded(expanded) {\n\t\tif (expanded !== (button.getAttribute(\"aria-expanded\") === \"true\")) {\n\t\t\tbutton.setAttribute(\"aria-expanded\", String(expanded));\n\t\t\tlabel.innerText = expanded ? closeLabel : openLabel;\n\t\t}\n\t}\n\n\tbutton.addEventListener(\"click\", function () {\n\t\tsetExpanded(button.getAttribute(\"aria-expanded\") === \"false\");\n\t});\n\n\treturn {\n\t\telement: button,\n\t\tsetExpanded: setExpanded,\n\t};\n}\n"],"names":["ensureElementHasId","element","id","tagName","Math","random","toString","initNaviation","headers","document","querySelectorAll","i","length","nav","querySelector","HTMLElement","makeResponsive","className","indexOf","isCondensed","menu","media","handler","mql","button","ul","openLabel","closeLabel","createElement","setAttribute","label","setExpanded","expanded","getAttribute","String","innerText","appendChild","addEventListener","createMenuButton","dataset","parentNode","insertBefore","event","matches","classList","remove","add","window","matchMedia","addListener","fn","readyState","onDomReady"],"mappings":"gCAeO,SAASA,mBAAmBC,SAC7BA,QAAQC,KACZD,QAAQC,GACPD,QAAQE,QAAU,KAAiC,OAAP,IAAhBC,KAAKC,WAAuBC,SAAS,KCR7D,SAASC,gBAEf,IADA,IAAIC,QAAUC,SAASC,iBAAiB,4BAC/BC,EAAI,EAAGA,EAAIH,QAAQI,OAAQD,IAAK,CACxC,IAAIE,IAAML,QAAQG,GAAGG,cAAc,OACnC,GAAMD,eAAeE,cAAgBF,IAAIC,cAAc,gBAIvDE,eAAeH,KADkD,IAA/CL,QAAQG,GAAGM,UAAUC,QAAQ,eASjD,SAASF,eAAeH,IAAKM,aAC5B,IAAIC,KAAOP,IAAIC,cAAc,UAC7B,GAAMM,gBAAgBL,YAAtB,CAGAf,mBAAmBoB,MAEnB,IDHiCC,MAAOC,QACpCC,ICEAC,OA6BL,SAA0BC,GAAIC,UAAWC,YACxC,IAAIH,OAASf,SAASmB,cAAc,UACpCJ,OAAOP,UAAY,cACnBO,OAAOK,aAAa,SAAU,SAC9BL,OAAOK,aAAa,gBAAiBJ,GAAGvB,IACxCsB,OAAOK,aAAa,gBAAiB,SAErC,IAAIC,MAAQrB,SAASmB,cAAc,QAQnC,SAASG,YAAYC,UAChBA,YAAuD,SAAzCR,OAAOS,aAAa,oBACrCT,OAAOK,aAAa,gBAAiBK,OAAOF,WAC5CF,MAAMK,UAAYH,SAAWL,WAAaD,WAQ5C,OAlBAI,MAAMK,UAAYT,UAClBI,MAAMb,UAAY,UAClBjB,mBAAmB8B,OAEnBN,OAAOY,YAAYN,OACnBN,OAAOK,aAAa,kBAAmBC,MAAM5B,IAS7CsB,OAAOa,iBAAiB,SAAS,WAChCN,YAAqD,UAAzCP,OAAOS,aAAa,qBAG1B,CACNhC,QAASuB,OACTO,YAAaA,aAzDDO,CACZlB,KACAP,IAAI0B,QAAQb,WAAa,OACzBb,IAAI0B,QAAQZ,YAAc,cAG3BP,KAAKoB,WAAWC,aAAajB,OAAOvB,QAASmB,MAExCD,cDX4BE,MCa/BR,IAAI0B,QAAQlB,OAAS,qBDbiBC,QCctC,SAAUoB,OACTlB,OAAOO,aAAY,GACfW,MAAMC,QACT9B,IAAI+B,UAAUC,OAAO,oBAErBhC,IAAI+B,UAAUE,IAAI,sBDlBlBvB,IAAMwB,OAAOC,WAAW3B,QAEpBgB,iBACPd,IAAIc,iBAAiB,SAAUf,SAE/BC,IAAI0B,YAAY3B,SAGjBA,QAAQC,QAlCF,SAAoB2B,IAC1B,GAA4B,YAAxBzC,SAAS0C,WAA0B,OAAOD,KAC9CzC,SAAS4B,iBAAiB,mBAAoBa,KCH/CE,CAAW7C"}